import{debounce}from"utils";class ScrollingLogos extends HTMLElement{constructor(){super(),this.debouncedUpdateMarqueeSettings=debounce(this.#e.bind(this),50),this.debouncedMouseEnter=debounce((()=>this.stop()),100),this.debouncedMouseLeave=debounce((()=>this.start()),100)}connectedCallback(){this.marqueeContent=this.querySelector(".scrolling-logos__track"),this.marqueeElements=Array.from(this.querySelectorAll(".scrolling-logos__item")),this.scrollSpeed=parseFloat(this.dataset.scrollSpeed),this.resizeObserver=new ResizeObserver(this.debouncedUpdateMarqueeSettings),this.resizeObserver.observe(this),this.debouncedUpdateMarqueeSettings(),this.#t(),"auto_hover_pause"===this.dataset.scrollStyle&&(this.addEventListener("pointerenter",this.debouncedMouseEnter),this.addEventListener("pointerleave",this.debouncedMouseLeave))}disconnectedCallback(){this.resizeObserver&&this.resizeObserver.unobserve(this),this.sectionObserver&&this.sectionObserver.disconnect(),"auto_hover_pause"===this.dataset.scrollStyle&&(this.removeEventListener("pointerenter",this.debouncedMouseEnter),this.removeEventListener("pointerleave",this.debouncedMouseLeave))}setAnimationState(e,t){this.marqueeContent.style.animationPlayState!==e&&(this.marqueeContent.style.animationPlayState=e,this.dispatchEvent(new CustomEvent(`on:scrolling-logos:${t}`)))}start(){this.setAnimationState("running","start")}stop(){this.setAnimationState("paused","stop")}#e(){const e=window.matchMedia("(max-width: 768px)").matches,t=getComputedStyle(this),s=e?"--scrolling-logo-size-mob":"--scrolling-logo-size-desk",o=e?"--scrolling-logo-spacing-mob":"--scrolling-logo-spacing-desk",i=(14-parseFloat(t.getPropertyValue(s)))*(e?.35:1),r=parseFloat(t.getPropertyValue(o))*(e?2:1),l=this.marqueeElements.length,n=r/100*window.innerWidth,a=parseFloat(this.style.getPropertyValue("--scrolling-logo-elements-displayed")),c=parseFloat(this.style.getPropertyValue("--scrolling-logo-elements")),h=parseFloat(this.style.getPropertyValue("--scrolling-logo-gap"));a!==i&&this.style.setProperty("--scrolling-logo-elements-displayed",i),c!==l&&this.style.setProperty("--scrolling-logo-elements",l),h!==r&&this.style.setProperty("--scrolling-logo-gap",`${r}vw`),this.#s(i),this.#o(n)}#s(e){const{marqueeContent:t,marqueeElements:s}=this,o=document.createDocumentFragment();if(this.lastDisplayedCount===e)return;for(this.clonePool||(this.clonePool=s.map((e=>e.cloneNode(!0))));t.children.length>s.length;)t.removeChild(t.lastChild);const i=Math.max(e,this.clonePool.length);for(let e=0;e<i;e+=1){const t=this.clonePool[e%this.clonePool.length].cloneNode(!0);o.appendChild(t)}t.appendChild(o),this.lastDisplayedCount=e}#o(e){const t=this.isMobile?15:20,s=this.scrollSpeed*t,o=this.marqueeElements.reduce(((t,s)=>t+s.offsetWidth+e),0)/s;this.style.setProperty("--scroll-duration",`${o}s`)}#t(){this.sectionObserver=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting?(this.start(),this.#i()):this.stop()}))}),{root:null,rootMargin:"0px",threshold:0}),this.sectionObserver.observe(this)}#i(){this.marqueeContent.querySelectorAll("img").forEach((e=>{const t=e;t.setAttribute("loading","eager"),t.dataset.src&&(t.src=t.dataset.src,t.removeAttribute("data-src"))}))}}customElements.define("scrolling-logos",ScrollingLogos);
//# sourceMappingURL=scrolling-logos.js.map
